{"ast":null,"code":"var _jsxFileName = \"/Users/new/Documents/PET-project`s/movie-search-app-personal-project-v1.1/src/pages/Movies/Movies.jsx\",\n  _s = $RefreshSig$();\nimport React, { useCallback, useEffect } from \"react\";\nimport { useSearchParams } from \"react-router-dom\";\nimport { useError } from \"../../contexts/ErrorContext\";\nimport { MovieList } from \"components/MovieList/MovieList\";\nimport { PageNavButtonsWrapper } from \"components/Buttons/PageNavButtons/PageNavButtonsWrapper\";\nimport { Form } from \"./MoviesForm/MoviesForm\";\nimport { useGetMovieByQueryQuery } from \"services/getMoviesRTK\";\nimport { Loader } from \"components/Loader/Loader\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Movies = () => {\n  _s();\n  var _data$results, _data$total_pages, _data$total_results;\n  const [searchParams, setSearchParams] = useSearchParams();\n  const {\n    handleMinorError,\n    handleWarning\n  } = useError();\n  const currentPage = searchParams.get(\"page\") || \"1\";\n  const currentQuery = searchParams.get(\"query\");\n  const {\n    data,\n    error,\n    isFetching\n  } = useGetMovieByQueryQuery({\n    query: currentQuery,\n    page: currentPage\n  }, {\n    skip: !currentQuery\n  });\n  const results = (_data$results = data === null || data === void 0 ? void 0 : data.results) !== null && _data$results !== void 0 ? _data$results : [];\n  const total_pages = (_data$total_pages = data === null || data === void 0 ? void 0 : data.total_pages) !== null && _data$total_pages !== void 0 ? _data$total_pages : 0;\n  const total_results = (_data$total_results = data === null || data === void 0 ? void 0 : data.total_results) !== null && _data$total_results !== void 0 ? _data$total_results : 0;\n  useEffect(() => {\n    if (error) {\n      handleMinorError(\"Failed to fetch movies. Please try again.\");\n    } else if (currentQuery && total_results === 0) {\n      handleWarning(\"Фильм не найден, пожалуйста введите другое название\");\n    }\n  }, [error, currentQuery, total_results, handleMinorError, handleWarning]);\n  const handlePageChange = useCallback(newPage => {\n    setSearchParams(prevParams => ({\n      ...Object.fromEntries(prevParams),\n      page: newPage.toString()\n    }));\n  }, [setSearchParams]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Form, {\n      setSearchParams: setSearchParams\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 7\n    }, this), isFetching && /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 22\n    }, this), results.length > 0 && /*#__PURE__*/_jsxDEV(MovieList, {\n      movies: results\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 30\n    }, this), results.length > 0 && /*#__PURE__*/_jsxDEV(PageNavButtonsWrapper, {\n      movies: results,\n      page: Number(currentPage) || 1,\n      totalPages: total_pages,\n      handlePageChange: handlePageChange\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n};\n_s(Movies, \"wJy1Y2gvns+cL1oGOpwW678L89Y=\", false, function () {\n  return [useSearchParams, useError, useGetMovieByQueryQuery];\n});\n_c = Movies;\nexport default Movies;\nvar _c;\n$RefreshReg$(_c, \"Movies\");","map":{"version":3,"names":["React","useCallback","useEffect","useSearchParams","useError","MovieList","PageNavButtonsWrapper","Form","useGetMovieByQueryQuery","Loader","jsxDEV","_jsxDEV","Fragment","_Fragment","Movies","_s","_data$results","_data$total_pages","_data$total_results","searchParams","setSearchParams","handleMinorError","handleWarning","currentPage","get","currentQuery","data","error","isFetching","query","page","skip","results","total_pages","total_results","handlePageChange","newPage","prevParams","Object","fromEntries","toString","children","fileName","_jsxFileName","lineNumber","columnNumber","length","movies","Number","totalPages","_c","$RefreshReg$"],"sources":["/Users/new/Documents/PET-project`s/movie-search-app-personal-project-v1.1/src/pages/Movies/Movies.jsx"],"sourcesContent":["import React, { useCallback, useEffect } from \"react\";\nimport { useSearchParams } from \"react-router-dom\";\nimport { useError } from \"../../contexts/ErrorContext\";\nimport { MovieList } from \"components/MovieList/MovieList\";\nimport { PageNavButtonsWrapper } from \"components/Buttons/PageNavButtons/PageNavButtonsWrapper\";\nimport { Form } from \"./MoviesForm/MoviesForm\";\nimport { useGetMovieByQueryQuery } from \"services/getMoviesRTK\";\nimport { Loader } from \"components/Loader/Loader\";\n\nconst Movies = () => {\n  const [searchParams, setSearchParams] = useSearchParams();\n  const { handleMinorError, handleWarning } = useError();\n  const currentPage = searchParams.get(\"page\") || \"1\";\n  const currentQuery = searchParams.get(\"query\");\n\n  const { data, error, isFetching } = useGetMovieByQueryQuery(\n    { query: currentQuery, page: currentPage },\n    { skip: !currentQuery }\n  );\n\n  const results = data?.results ?? [];\n  const total_pages = data?.total_pages ?? 0;\n  const total_results = data?.total_results ?? 0;\n\n  useEffect(() => {\n    if (error) {\n      handleMinorError(\"Failed to fetch movies. Please try again.\");\n    } else if (currentQuery && total_results === 0) {\n      handleWarning(\"Фильм не найден, пожалуйста введите другое название\");\n    }\n  }, [error, currentQuery, total_results, handleMinorError, handleWarning]);\n\n  const handlePageChange = useCallback(\n    (newPage) => {\n      setSearchParams((prevParams) => ({\n        ...Object.fromEntries(prevParams),\n        page: newPage.toString(),\n      }));\n    },\n    [setSearchParams]\n  );\n\n  return (\n    <>\n      <Form setSearchParams={setSearchParams} />\n      {isFetching && <Loader />}\n      {results.length > 0 && <MovieList movies={results} />}\n      {results.length > 0 && (\n        <PageNavButtonsWrapper\n          movies={results}\n          page={Number(currentPage) || 1}\n          totalPages={total_pages}\n          handlePageChange={handlePageChange}\n        />\n      )}\n    </>\n  );\n};\n\nexport default Movies;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}