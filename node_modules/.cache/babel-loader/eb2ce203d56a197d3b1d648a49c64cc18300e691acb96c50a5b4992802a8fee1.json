{"ast":null,"code":"var _jsxFileName = \"/Users/new/Documents/PET-project`s/movie-search-app-personal-project-v1.1/src/pages/Movies/Movies.jsx\",\n  _s = $RefreshSig$();\nimport { useCallback, useEffect, useState } from \"react\";\nimport { useSearchParams } from \"react-router-dom\";\nimport { getMovieByQuery } from \"services/getMovies\";\nimport { useError } from \"../../contexts/ErrorContext\";\nimport { MovieList } from \"components/MovieList/MovieList\";\nimport { PageNavButtonsWrapper } from \"components/Buttons/PageNavButtons/PageNavButtonsWrapper\";\nimport { Form } from \"./MoviesForm/MoviesForm\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Movies = () => {\n  _s();\n  const [movies, setMovies] = useState([]);\n  const [totalPagesState, setTotalPagesState] = useState(0);\n  const [searchParams, setSearchParams] = useSearchParams();\n  const {\n    handleMinorError,\n    handleWarning\n  } = useError();\n  const currentPage = searchParams.get(\"page\") || \"1\";\n  useEffect(() => {\n    const currentQuery = searchParams.get(\"query\");\n    if (!currentQuery) {\n      return;\n    }\n\n    // if (!searchParams.has(\"page\")) {\n    //   setSearchParams();\n    // }\n\n    const fetchMovieByQuery = async () => {\n      try {\n        const moviesByQueryResponse = await getMovieByQuery(currentQuery, currentPage);\n        const {\n          results,\n          total_pages,\n          total_results\n        } = moviesByQueryResponse;\n        if (total_results === 0) {\n          handleWarning(\"Фильм не найден, пожалуйста введите другое название\");\n          return;\n        }\n        setTotalPagesState(total_pages);\n        setMovies(results);\n      } catch (error) {\n        handleMinorError(\"Failed to fetch movies. Please try again.\");\n      }\n    };\n    fetchMovieByQuery();\n  }, [searchParams]);\n  const handlePageChange = useCallback(newPage => {\n    setSearchParams(prevParams => ({\n      ...Object.fromEntries(prevParams),\n      page: newPage.toString()\n    }));\n  }, [setSearchParams]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Form, {\n      setSearchParams: setSearchParams\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this), movies.length > 0 && /*#__PURE__*/_jsxDEV(MovieList, {\n      movies: movies\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 29\n    }, this), movies.length > 0 && /*#__PURE__*/_jsxDEV(PageNavButtonsWrapper, {\n      movies: movies,\n      page: Number(searchParams.get(\"page\")) || 1,\n      totalPages: totalPagesState,\n      handlePageChange: handlePageChange\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n};\n_s(Movies, \"Z6J6jLxb+kJrJEb5qcALIP/x7OU=\", false, function () {\n  return [useSearchParams, useError];\n});\n_c = Movies;\nexport default Movies;\n\n///\n///\n///\n///\n///\nvar _c;\n$RefreshReg$(_c, \"Movies\");","map":{"version":3,"names":["useCallback","useEffect","useState","useSearchParams","getMovieByQuery","useError","MovieList","PageNavButtonsWrapper","Form","jsxDEV","_jsxDEV","Fragment","_Fragment","Movies","_s","movies","setMovies","totalPagesState","setTotalPagesState","searchParams","setSearchParams","handleMinorError","handleWarning","currentPage","get","currentQuery","fetchMovieByQuery","moviesByQueryResponse","results","total_pages","total_results","error","handlePageChange","newPage","prevParams","Object","fromEntries","page","toString","children","fileName","_jsxFileName","lineNumber","columnNumber","length","Number","totalPages","_c","$RefreshReg$"],"sources":["/Users/new/Documents/PET-project`s/movie-search-app-personal-project-v1.1/src/pages/Movies/Movies.jsx"],"sourcesContent":["import { useCallback, useEffect, useState } from \"react\";\nimport { useSearchParams } from \"react-router-dom\";\nimport { getMovieByQuery } from \"services/getMovies\";\n\nimport { useError } from \"../../contexts/ErrorContext\";\n\nimport { MovieList } from \"components/MovieList/MovieList\";\nimport { PageNavButtonsWrapper } from \"components/Buttons/PageNavButtons/PageNavButtonsWrapper\";\nimport { Form } from \"./MoviesForm/MoviesForm\";\nconst Movies = () => {\n  const [movies, setMovies] = useState([]);\n  const [totalPagesState, setTotalPagesState] = useState(0);\n\n  const [searchParams, setSearchParams] = useSearchParams();\n  const { handleMinorError, handleWarning } = useError();\n  const currentPage = searchParams.get(\"page\") || \"1\";\n\n  useEffect(() => {\n    const currentQuery = searchParams.get(\"query\");\n\n    if (!currentQuery) {\n      return;\n    }\n\n    // if (!searchParams.has(\"page\")) {\n    //   setSearchParams();\n    // }\n\n    const fetchMovieByQuery = async () => {\n      try {\n        const moviesByQueryResponse = await getMovieByQuery(\n          currentQuery,\n          currentPage\n        );\n        const { results, total_pages, total_results } = moviesByQueryResponse;\n        if (total_results === 0) {\n          handleWarning(\"Фильм не найден, пожалуйста введите другое название\");\n          return;\n        }\n        setTotalPagesState(total_pages);\n        setMovies(results);\n      } catch (error) {\n        handleMinorError(\"Failed to fetch movies. Please try again.\");\n      }\n    };\n\n    fetchMovieByQuery();\n  }, [searchParams]);\n\n  const handlePageChange = useCallback(\n    (newPage) => {\n      setSearchParams((prevParams) => ({\n        ...Object.fromEntries(prevParams),\n        page: newPage.toString(),\n      }));\n    },\n    [setSearchParams]\n  );\n\n  return (\n    <>\n      <Form setSearchParams={setSearchParams} />\n      {movies.length > 0 && <MovieList movies={movies} />}\n      {movies.length > 0 && (\n        <PageNavButtonsWrapper\n          movies={movies}\n          page={Number(searchParams.get(\"page\")) || 1}\n          totalPages={totalPagesState}\n          handlePageChange={handlePageChange}\n        />\n      )}\n    </>\n  );\n};\n\nexport default Movies;\n\n///\n///\n///\n///\n///\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}