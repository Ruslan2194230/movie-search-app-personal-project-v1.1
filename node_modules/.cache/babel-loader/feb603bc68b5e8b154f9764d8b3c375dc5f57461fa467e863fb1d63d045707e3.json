{"ast":null,"code":"import{useCallback,useEffect,useState}from'react';import{useSearchParams}from'react-router-dom';import{getMovieByQuery}from'services/getMovies';import{useError}from'../../contexts/ErrorContext';import{MovieList}from'components/MovieList/MovieList';import{PageNavButtonsWrapper}from'components/Buttons/PageNavButtons/PageNavButtonsWrapper';import{Form}from'./MoviesForm/MoviesForm';import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";const Movies=()=>{const[movies,setMovies]=useState([]);const[totalPagesState,setTotalPagesState]=useState(0);const[searchParams,setSearchParams]=useSearchParams();const{handleMinorError,handleWarning}=useError();useEffect(()=>{const currentQuery=searchParams.get('query');const currentPage=searchParams.get('page')||'1';if(!currentQuery){return;}if(!searchParams.has('page')){setSearchParams({query:currentQuery,page:currentPage});}const fetchMovieByQuery=async()=>{try{const moviesByQueryResponse=await getMovieByQuery(currentQuery,currentPage);const{results,total_pages,total_results}=moviesByQueryResponse;if(total_results===0){handleWarning('Фильм не найден, пожалуйста введите другое название');return;}setTotalPagesState(total_pages);setMovies(results);}catch(error){handleMinorError('Failed to fetch movies. Please try again.');}};fetchMovieByQuery();},[searchParams,setSearchParams,handleWarning,handleMinorError]);const handlePageChange=useCallback(newPage=>{setSearchParams(prevParams=>({...Object.fromEntries(prevParams),page:newPage.toString()}));},[setSearchParams]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Form,{setSearchParams:setSearchParams}),movies.length>0&&/*#__PURE__*/_jsx(MovieList,{movies:movies}),movies.length>0&&/*#__PURE__*/_jsx(PageNavButtonsWrapper,{movies:movies,page:Number(searchParams.get('page'))||1,totalPages:totalPagesState,handlePageChange:handlePageChange})]});};export default Movies;///\n///\n///\n///\n///","map":{"version":3,"names":["useCallback","useEffect","useState","useSearchParams","getMovieByQuery","useError","MovieList","PageNavButtonsWrapper","Form","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","Movies","movies","setMovies","totalPagesState","setTotalPagesState","searchParams","setSearchParams","handleMinorError","handleWarning","currentQuery","get","currentPage","has","query","page","fetchMovieByQuery","moviesByQueryResponse","results","total_pages","total_results","error","handlePageChange","newPage","prevParams","Object","fromEntries","toString","children","length","Number","totalPages"],"sources":["/Users/new/Documents/PET-project`s/movie-search-app-personal-project-v1.0/src/pages/Movies/Movies.jsx"],"sourcesContent":["import { useCallback, useEffect, useState } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport { getMovieByQuery } from 'services/getMovies';\n\nimport { useError } from '../../contexts/ErrorContext';\n\nimport { MovieList } from 'components/MovieList/MovieList';\nimport { PageNavButtonsWrapper } from 'components/Buttons/PageNavButtons/PageNavButtonsWrapper';\nimport { Form } from './MoviesForm/MoviesForm';\n\nconst Movies = () => {\n  const [movies, setMovies] = useState([]);\n  const [totalPagesState, setTotalPagesState] = useState(0);\n\n  const [searchParams, setSearchParams] = useSearchParams();\n  const { handleMinorError, handleWarning } = useError();\n\n  useEffect(() => {\n    const currentQuery = searchParams.get('query');\n    const currentPage = searchParams.get('page') || '1';\n\n    if (!currentQuery) {\n      return;\n    }\n\n    if (!searchParams.has('page')) {\n      setSearchParams({ query: currentQuery, page: currentPage });\n    }\n\n    const fetchMovieByQuery = async () => {\n      try {\n        const moviesByQueryResponse = await getMovieByQuery(\n          currentQuery,\n          currentPage\n        );\n        const { results, total_pages, total_results } = moviesByQueryResponse;\n        if (total_results === 0) {\n          handleWarning('Фильм не найден, пожалуйста введите другое название');\n          return;\n        }\n        setTotalPagesState(total_pages);\n        setMovies(results);\n      } catch (error) {\n        handleMinorError('Failed to fetch movies. Please try again.');\n      }\n    };\n\n    fetchMovieByQuery();\n  }, [searchParams, setSearchParams, handleWarning, handleMinorError]);\n\n  const handlePageChange = useCallback(\n    newPage => {\n      setSearchParams(prevParams => ({\n        ...Object.fromEntries(prevParams),\n        page: newPage.toString(),\n      }));\n    },\n    [setSearchParams]\n  );\n\n  return (\n    <>\n      <Form setSearchParams={setSearchParams} />\n      {movies.length > 0 && <MovieList movies={movies} />}\n      {movies.length > 0 && (\n        <PageNavButtonsWrapper\n          movies={movies}\n          page={Number(searchParams.get('page')) || 1}\n          totalPages={totalPagesState}\n          handlePageChange={handlePageChange}\n        />\n      )}\n    </>\n  );\n};\n\nexport default Movies;\n\n///\n///\n///\n///\n///\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}